% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/cb_umi_exons.R
\name{cb_umi_exons}
\alias{cb_umi_exons}
\title{Map Cell Barcode + UMI to Overlapping Exons}
\usage{
cb_umi_exons(tsv, meta_exons)
}
\arguments{
\item{tsv}{Character. Path to the blocks TSV. Required columns: CB, UMI,
block_start, block_end, block_seq (block_* may contain \";\"-separated lists).}

\item{meta_exons}{Character. Path to the exon metadata TSV. Required columns:
chr, start, end, exon (or exon_id). start/end must be integer coordinates.}
}
\value{
A data.table of overlapping records. Columns include at minimum:
CB, UMI, block_start, block_end, start, end, exon (columns produced by foverlaps).
Each row represents one block-entry (after expansion) overlapping one exon.
}
\description{
Expand semicolon-delimited block fields and identify exons that overlap
each block for every (CB, UMI) pair. The function reads a blocks TSV (produced by
extract_exon_reads_hts()) where block_start, block_end and block_seq may contain
multiple entries separated by ";" and a meta exons TSV describing exon coordinates.
}
\details{
The function:
\enumerate{
\item reads the blocks TSV and expands rows with semicolon-separated fields using
tidyr::separate_rows();
\item coerces block coordinates to integer;
\item reads the exon metadata and selects the required columns;
\item uses data.table::foverlaps() to find any overlap between blocks and exons.
}
}
\examples{
\dontrun{
  blocks_tsv <- "AI.tsv"
  exons_tsv  <- "meta_exons.tsv"
  res <- cb_umi_exons(tsv = blocks_tsv, meta_exons = exons_tsv)
  head(res)
}
}
\seealso{
data.table::foverlaps, tidyr::separate_rows
}
